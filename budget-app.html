<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Budget App</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
  <body class="bg-gray-100 min-h-screen p-4">

    <div class="max-w-xl mx-auto bg-white rounded-xl shadow-md p-6 space-y-6">
      <h1 class="text-2xl font-bold text-center text-indigo-700">Budget App</h1>

        <div class="space-y-2">
          <form onsubmit="setBudget(event)">
            <label class="block text-sm font-semibold">Set Budget:</label>
            <input type="number" id="budgetInput" placeholder="Enter budget amount" class="w-full border p-2 rounded" />
            <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded w-full mt-2">Set
              Budget</button>
          </form>
        </div>
      

      <div class="grid grid-cols-3 gap-4 text-center font-semibold text-white">
        <div class="bg-blue-500 rounded p-4">
          <p>Budget</p>
          <p id="budgeted">₦0</p>
        </div>
        <div class="bg-red-500 rounded p-4">
          <p>Spent</p>
          <p id="spent">₦0</p>
        </div>
        <div class="bg-green-500 rounded p-4">
          <p>Left</p>
          <p id="left">₦0</p>
        </div>
      </div>

        <div class="space-y-2">
          <form onsubmit="addExpense(event)">
            <label class="block text-sm font-semibold">Add Expense:</label>
            <input type="number" id="expenseAmount" placeholder="Amount" class="w-full border p-2 rounded" />
            <input type="text" id="expenseDesc" placeholder="What is it for?" class="w-full border p-2 rounded" />
            <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded w-full font-semibold">Add
              Entry</button>
          </form>
        </div>

      <div>
        <h2 class="text-lg font-semibold mb-2">Budget History:</h2>
        <ul id="history" class="space-y-2 max-h-60 overflow-y-auto"></ul>
        <button onclick="resetBudget()" class="bg-red-700 text-white px-4 py-2 rounded w-full font-semibold mt-4 hover:bg-red-800">
          Reset Entire Budget
        </button>
      </div>
    </div>

    <script>
      let budget = 0;
      let spent = 0;
      let left = 0;
      budgetArray = [];
      let editIndex = null;

      function setBudget(event) {
        event.preventDefault();

        budget = document.getElementById("budgetInput").value;
        budget = Number(budget);
        left = budget - spent;
        budgeted.innerHTML = "₦" + budget;
        left.innerHTML = "₦" + left;
      }

      function addExpense(event) {
        event.preventDefault();

        const expenseInput = document.getElementById("expenseAmount");
        const descInput = document.getElementById("expenseDesc");
        const amount = Number(expenseInput.value);
        const purpose = descInput.value;

        if (!amount || !purpose) {
          console.log("Please enter both amount and purpose");
          return;
        }

        if (editIndex !== null) {
          const oldAmount = budgetArray[editIndex].amount;
          budgetArray[editIndex] = { amount, purpose };

          spent = spent - oldAmount + amount;
          left = budget - spent;

          editIndex = null;
          saveToLocalStorage();
        } else {
          budgetArray.push({ amount, purpose });
          spent += amount;
        }
        left = budget - spent;

        document.getElementById("spent").innerHTML = "₦" + spent;
        document.getElementById("left").innerHTML = "₦" + left;

        expenseInput.value = "";
        descInput.value = "";

        showHistory();
        saveToLocalStorage();
      }

      function showHistory() {
        const history = document.getElementById("history");
        history.innerHTML = "";

        budgetArray.forEach((item, i) => {
          history.innerHTML += `
          <div class="flex justify-between items-center bg-gray-100 p-2 rounded font-semibold">
            <div>${i + 1}.</div>
            <div>₦${item.amount}</div>
            <div>${item.purpose}</div>
            <div>
            <button onclick="del(${i})" class="bg-red-600 p-1 rounded hover:bg-white hover:text-red-600 font-bold text-white ">Delete</button>
            <button onclick="edit(${i})" class="bg-blue-600 p-1 rounded hover:bg-white hover:text-blue-600 font-bold text-white ">Edit</button>
            </div>
          </div>
        `;
        });
      }

      function saveToLocalStorage() {
        localStorage.setItem("budget", budget);
        localStorage.setItem("spent", spent);
        localStorage.setItem("left", left);
        localStorage.setItem("budgetArray", JSON.stringify(budgetArray));
      }

      function handleFetch() {
        if (localStorage.getItem("budget")) {
          budget = Number(localStorage.getItem("budget"));
          spent = Number(localStorage.getItem("spent"));
          left = Number(localStorage.getItem("left"));
          budgetArray = JSON.parse(localStorage.getItem("budgetArray"));

          document.getElementById("budgeted").innerHTML = "₦" + budget;
          document.getElementById("spent").innerHTML = "₦" + spent;
          document.getElementById("left").innerHTML = "₦" + left;
          showHistory();
        }
      };

      function del(index) {
        const deletedAmount = budgetArray[index].amount;
        budgetArray.splice(index, 1);
        spent -= deletedAmount;
        left = budget - spent;

        document.getElementById("spent").innerHTML = "₦" + spent;
        document.getElementById("left").innerHTML = "₦" + left;

        saveToLocalStorage();
        showHistory();
      }

      function edit(index) {
        const item = budgetArray[index];
        document.getElementById("expenseAmount").value = item.amount;
        document.getElementById("expenseDesc").value = item.purpose;
        editIndex = index;
      }

      function resetBudget() {
        if (confirm("Are you sure you want to reset your entire budget and history?")) {
          budget = 0;
          spent = 0;
          left = 0;
          budgetArray = [];
          editIndex = null;

          localStorage.removeItem("budget");
          localStorage.removeItem("spent");
          localStorage.removeItem("left");
          localStorage.removeItem("budgetArray");

          document.getElementById("budgeted").innerHTML = "₦0";
          document.getElementById("spent").innerHTML = "₦0";
          document.getElementById("left").innerHTML = "₦0";
          document.getElementById("history").innerHTML = "";

          document.getElementById("budgetInput").value = "";
          document.getElementById("expenseAmount").value = "";
          document.getElementById("expenseDesc").value = "";

          alert("Budget and history have been reset.");
        }
      }

      handleFetch();
    </script>
  </body>
</html>